<template>
  <div class="self-challenge">
    <h2>ğŸ¯ è‡ªæˆ‘è©¦ç…‰ - Watcher è§€å¯Ÿè€…</h2>
    <p class="route-info">ğŸ“ è·¯å¾‘ï¼š/WatcherSamples/SelfChallengeDemo.vue</p>
    <p class="description">
      ğŸ“ <strong>æŒ‘æˆ°ä»»å‹™ï¼š</strong>å»ºç«‹ä¸€å€‹æ•¸æ“šç›£æ§ç³»çµ±ï¼Œç·´ç¿’ watch å’Œ watchEffect çš„ä½¿ç”¨
    </p>

    <div class="challenge-section">
      <h3>ğŸ¯ æŒ‘æˆ°æ¸…å–®</h3>
      <div class="task-list">
        <div class="task-item">
          <input type="checkbox" id="task1">
          <label for="task1">1. ä½¿ç”¨ watch ç›£æ§åŸºæœ¬æ•¸æ“šè®ŠåŒ–</label>
        </div>
        <div class="task-item">
          <input type="checkbox" id="task2">
          <label for="task2">2. å¯¦ä½œæ·±åº¦ç›£æ§ï¼ˆdeep watchï¼‰</label>
        </div>
        <div class="task-item">
          <input type="checkbox" id="task3">
          <label for="task3">3. ä½¿ç”¨ watchEffect è‡ªå‹•è¿½è¹¤ä¾è³´</label>
        </div>
        <div class="task-item">
          <input type="checkbox" id="task4">
          <label for="task4">4. å¯¦ä½œæ¢ä»¶æ€§ç›£æ§å’Œåœæ­¢ç›£æ§</label>
        </div>
        <div class="task-item">
          <input type="checkbox" id="task5">
          <label for="task5">5. ç›£æ§å¤šå€‹æ•¸æ“šæºä¸¦åšå‡ºéŸ¿æ‡‰</label>
        </div>
        <div class="task-item">
          <input type="checkbox" id="task6">
          <label for="task6">6. å»ºç«‹å®Œæ•´çš„æ•¸æ“šç›£æ§æ—¥èªŒç³»çµ±</label>
        </div>
      </div>
    </div>

    <div class="implementation-section">
      <h3>ğŸ‘¨â€ğŸ’» å¯¦ä½œç·´ç¿’è©³æƒ…</h3>
      <p class="implementation-intro">
        ğŸ“‹ <strong>è«‹åœ¨ &lt;script setup&gt; å€åŸŸå®Œæˆä»¥ä¸‹å‡½æ•¸çš„å¯¦ä½œï¼š</strong>
      </p>

      <div class="implementation-list">
        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">1.</span>
            <span class="function-name">userLevel (computed)</span>
            <span class="difficulty easy">ç°¡å–®</span>
          </div>
          <div class="function-description">
            è¨ˆç®—ç”¨æˆ¶ç­‰ç´šé‚è¼¯ï¼ˆåŸºæ–¼å¹´é½¡å’Œæ´»èºåº¦ï¼‰
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>å¹´é½¡åˆ†æ®µï¼š</strong>18æ­²ä»¥ä¸‹(Youth)ã€18-30æ­²(Adult)ã€30-50æ­²(Senior)ã€50æ­²ä»¥ä¸Š(Elder)</li>
                <li><strong>æ´»èºåº¦ç­‰ç´šï¼š</strong>0-25%(Low)ã€26-50%(Medium)ã€51-75%(High)ã€76-100%(VeryHigh)</li>
                <li><strong>ç­‰ç´šè¨ˆç®—ï¼š</strong>
                  <ul>
                    <li>Bronze: Youth + Low/Medium æˆ– Adult + Low</li>
                    <li>Silver: Adult + Medium/High æˆ– Senior + Low/Medium</li>
                    <li>Gold: Senior + High æˆ– Elder + Medium/High æˆ– Adult + VeryHigh</li>
                    <li>Platinum: Elder + VeryHigh æˆ– Senior + VeryHigh</li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">2.</span>
            <span class="function-name">addLog(type, message)</span>
            <span class="difficulty easy">ç°¡å–®</span>
          </div>
          <div class="function-description">
            å¯¦ä½œæ·»åŠ æ—¥èªŒçš„è¼”åŠ©å‡½æ•¸
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>åƒæ•¸ï¼š</strong>type (string): æ—¥èªŒé¡å‹, message (string): æ—¥èªŒè¨Šæ¯</li>
                <li><strong>æ—¥èªŒæ ¼å¼ï¼š</strong>{ time: string, type: string, message: string }</li>
                <li><strong>æ™‚é–“æ ¼å¼ï¼š</strong>ä½¿ç”¨ new Date().toLocaleTimeString() ç”¢ç”Ÿ HH:MM:SS æ ¼å¼</li>
                <li><strong>æ“ä½œï¼š</strong>å°‡æ—¥èªŒç‰©ä»¶æ¨å…¥ logs.value é™£åˆ—ï¼Œä¸¦å°‡ totalChanges.value += 1</li>
                <li><strong>æ—¥èªŒé¡å‹ï¼š</strong>'watch', 'watchEffect', 'deep', 'activity', 'multiple'</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">3.</span>
            <span class="function-name">watchUserName()</span>
            <span class="difficulty medium">ä¸­ç­‰</span>
          </div>
          <div class="function-description">
            ä½¿ç”¨ watch ç›£æ§ user.name çš„è®ŠåŒ–
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>ç›£æ§å°è±¡ï¼š</strong>() => user.name (ä½¿ç”¨ getter å‡½æ•¸)</li>
                <li><strong>è§¸ç™¼æ¢ä»¶ï¼š</strong>åƒ…åœ¨ watchSettings.enableNameWatch ç‚º true æ™‚å•Ÿç”¨</li>
                <li><strong>æ—¥èªŒå…§å®¹ï¼š</strong>`ç”¨æˆ¶åå¾ "${oldValue}" è®Šæ›´ç‚º "${newValue}"`</li>
                <li><strong>é¸é …ï¼š</strong>{ immediate: false } (ä¸ç«‹å³åŸ·è¡Œ)</li>
                <li><strong>è¿”å›å€¼ï¼š</strong>å°‡åœæ­¢å‡½æ•¸å­˜å…¥ watchers.value é™£åˆ—</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">4.</span>
            <span class="function-name">watchUserDeep()</span>
            <span class="difficulty medium">ä¸­ç­‰</span>
          </div>
          <div class="function-description">
            ä½¿ç”¨ watch æ·±åº¦ç›£æ§æ•´å€‹ user å°è±¡
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>ç›£æ§å°è±¡ï¼š</strong>user (reactive å°è±¡)</li>
                <li><strong>è§¸ç™¼æ¢ä»¶ï¼š</strong>åƒ…åœ¨ watchSettings.enableDeepWatch ç‚º true æ™‚å•Ÿç”¨</li>
                <li><strong>é¸é …ï¼š</strong>{ deep: true, immediate: false }</li>
                <li><strong>æ—¥èªŒå…§å®¹ï¼š</strong>`ç”¨æˆ¶è³‡æ–™ç™¼ç”Ÿæ·±åº¦è®ŠåŒ– (ç­‰ç´š: ${userLevel.value})`</li>
                <li><strong>æ—¥èªŒé¡å‹ï¼š</strong>'deep'</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">5.</span>
            <span class="function-name">watchActivityLevel()</span>
            <span class="difficulty medium">ä¸­ç­‰</span>
          </div>
          <div class="function-description">
            ç›£æ§ user.activityLevel çš„è®ŠåŒ–
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>ç›£æ§å°è±¡ï¼š</strong>() => user.activityLevel</li>
                <li><strong>è§¸ç™¼æ¢ä»¶ï¼š</strong>åƒ…åœ¨ watchSettings.enableActivityWatch ç‚º true æ™‚å•Ÿç”¨</li>
                <li><strong>é¸é …ï¼š</strong>{ immediate: true } (ç«‹å³åŸ·è¡Œä¸€æ¬¡)</li>
                <li><strong>ç‰¹æ®Šé‚è¼¯ï¼š</strong>
                  <ul>
                    <li>æ´»èºåº¦ >= 80: `ğŸ”¥ ç”¨æˆ¶æ´»èºåº¦æ¥µé«˜ï¼(${newValue}%)`</li>
                    <li>æ´»èºåº¦ >= 60: `âš¡ ç”¨æˆ¶æ´»èºåº¦è‰¯å¥½ (${newValue}%)`</li>
                    <li>æ´»èºåº¦ < 30: `ğŸ˜´ ç”¨æˆ¶æ´»èºåº¦åä½ (${newValue}%)`</li>
                    <li>å…¶ä»–: `ğŸ“Š æ´»èºåº¦è®Šæ›´ç‚º ${newValue}%`</li>
                  </ul>
                </li>
                <li><strong>æ—¥èªŒé¡å‹ï¼š</strong>'activity'</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">6.</span>
            <span class="function-name">setupWatchEffect()</span>
            <span class="difficulty medium">ä¸­ç­‰</span>
          </div>
          <div class="function-description">
            ä½¿ç”¨ watchEffect è‡ªå‹•è¿½è¹¤ç”¨æˆ¶æ•¸æ“šè®ŠåŒ–
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>è‡ªå‹•è¿½è¹¤ï¼š</strong>user.name, user.age, user.activityLevel, user.hobbies.length</li>
                <li><strong>è§¸ç™¼æ™‚æ©Ÿï¼š</strong>ä»»ä½•è¢«è¿½è¹¤çš„æ•¸æ“šç™¼ç”Ÿè®ŠåŒ–æ™‚</li>
                <li><strong>æ—¥èªŒå…§å®¹ï¼š</strong>`ğŸ¤– watchEffect: ${user.name}(${user.age}æ­²) æ´»èºåº¦${user.activityLevel}%
                  èˆˆè¶£${user.hobbies.length}é …`</li>
                <li><strong>æ—¥èªŒé¡å‹ï¼š</strong>'watchEffect'</li>
                <li><strong>è¿”å›å€¼ï¼š</strong>å°‡åœæ­¢å‡½æ•¸å­˜å…¥ watchers.value é™£åˆ—</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">7.</span>
            <span class="function-name">watchMultipleSources()</span>
            <span class="difficulty hard">å›°é›£</span>
          </div>
          <div class="function-description">
            åŒæ™‚ç›£æ§ç”¨æˆ¶åå’Œå¹´é½¡çš„è®ŠåŒ–
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>ç›£æ§å°è±¡ï¼š</strong>[() => user.name, () => user.age] (æ•¸çµ„å½¢å¼)</li>
                <li><strong>å›èª¿åƒæ•¸ï¼š</strong>([newName, newAge], [oldName, oldAge])</li>
                <li><strong>æ—¥èªŒå…§å®¹ï¼š</strong>
                  <ul>
                    <li>åå­—è®ŠåŒ–: `ğŸ‘¤ ç”¨æˆ¶å: ${oldName} â†’ ${newName}`</li>
                    <li>å¹´é½¡è®ŠåŒ–: `ğŸ‚ å¹´é½¡: ${oldAge} â†’ ${newAge}`</li>
                    <li>åŒæ™‚è®ŠåŒ–: `ğŸ“ ç”¨æˆ¶è³‡æ–™æ›´æ–°: ${newName}(${newAge}æ­²)`</li>
                  </ul>
                </li>
                <li><strong>æ—¥èªŒé¡å‹ï¼š</strong>'multiple'</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">8.</span>
            <span class="function-name">clearLogs()</span>
            <span class="difficulty easy">ç°¡å–®</span>
          </div>
          <div class="function-description">
            æ¸…é™¤æ‰€æœ‰æ—¥èªŒè¨˜éŒ„
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>æ“ä½œ 1ï¼š</strong>å°‡ logs.value è¨­ç‚ºç©ºé™£åˆ— []</li>
                <li><strong>æ“ä½œ 2ï¼š</strong>å°‡ totalChanges.value é‡ç½®ç‚º 0</li>
                <li><strong>æç¤ºï¼š</strong>åŸ·è¡Œå¾Œæ‡‰è©²æœƒçœ‹åˆ° "æš«ç„¡ç›£æ§æ—¥èªŒ" çš„è¨Šæ¯</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">9.</span>
            <span class="function-name">stopAllWatchers()</span>
            <span class="difficulty hard">å›°é›£</span>
          </div>
          <div class="function-description">
            åœæ­¢æ‰€æœ‰æ´»èºçš„ç›£æ§å™¨
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>æ“ä½œï¼š</strong>éæ­· watchers.value é™£åˆ—ï¼Œèª¿ç”¨æ¯å€‹åœæ­¢å‡½æ•¸</li>
                <li><strong>æ¸…ç†ï¼š</strong>åŸ·è¡Œå®Œç•¢å¾Œå°‡ watchers.value è¨­ç‚ºç©ºé™£åˆ—</li>
                <li><strong>æ—¥èªŒï¼š</strong>ä½¿ç”¨ addLog è¨˜éŒ„ `â¹ï¸ å·²åœæ­¢æ‰€æœ‰ç›£æ§å™¨ (å…±${count}å€‹)`</li>
                <li><strong>æ—¥èªŒé¡å‹ï¼š</strong>'watch'</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">10.</span>
            <span class="function-name">startAllWatchers()</span>
            <span class="difficulty hard">å›°é›£</span>
          </div>
          <div class="function-description">
            é‡æ–°å•Ÿå‹•æ‰€æœ‰ç›£æ§å™¨
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>å‰ç½®ä½œæ¥­ï¼š</strong>å…ˆèª¿ç”¨ stopAllWatchers() æ¸…é™¤ç¾æœ‰ç›£æ§</li>
                <li><strong>æ¢ä»¶å•Ÿå‹•ï¼š</strong>æ ¹æ“š watchSettings çš„ç‹€æ…‹æ±ºå®šå•Ÿå‹•å“ªäº›ç›£æ§å™¨ï¼š
                  <ul>
                    <li>enableNameWatch â†’ èª¿ç”¨ watchUserName()</li>
                    <li>enableDeepWatch â†’ èª¿ç”¨ watchUserDeep()</li>
                    <li>enableActivityWatch â†’ èª¿ç”¨ watchActivityLevel()</li>
                  </ul>
                </li>
                <li><strong>å›ºå®šå•Ÿå‹•ï¼š</strong>ç¸½æ˜¯èª¿ç”¨ setupWatchEffect() å’Œ watchMultipleSources()</li>
                <li><strong>æ—¥èªŒï¼š</strong>`ğŸš€ å·²é‡æ–°å•Ÿå‹•ç›£æ§ç³»çµ±`</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="implementation-item">
          <div class="function-header">
            <span class="function-number">11.</span>
            <span class="function-name">onUnmounted æ¸…ç†</span>
            <span class="difficulty medium">ä¸­ç­‰</span>
          </div>
          <div class="function-description">
            åœ¨çµ„ä»¶å¸è¼‰æ™‚æ¸…ç†æ‰€æœ‰ç›£æ§å™¨
            <div class="spec-details">
              <strong>ğŸ“‹ è©³ç´°è¦æ ¼ï¼š</strong>
              <ul>
                <li><strong>æ¸…ç†æ™‚æ©Ÿï¼š</strong>çµ„ä»¶å¾ DOM ä¸­ç§»é™¤ä¹‹å‰</li>
                <li><strong>æ¸…ç†å…§å®¹ï¼š</strong>èª¿ç”¨ stopAllWatchers() åœæ­¢æ‰€æœ‰ç›£æ§</li>
                <li><strong>é˜²æ­¢è¨˜æ†¶é«”æ´©æ¼ï¼š</strong>ç¢ºä¿æ‰€æœ‰ watcher éƒ½è¢«æ­£ç¢ºæ¸…ç†</li>
                <li><strong>å¯¦ä½œä½ç½®ï¼š</strong>åœ¨ onUnmounted(() => { ... }) å›èª¿å‡½æ•¸ä¸­</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="implementation-tips">
        <h4>ğŸ”§ å¯¦ä½œæç¤º</h4>
        <ul>
          <li><strong>ç›£æ§è¨­å®šï¼š</strong>æ³¨æ„æª¢æŸ¥ watchSettings çš„ç‹€æ…‹ä¾†æ±ºå®šæ˜¯å¦å•Ÿç”¨ç‰¹å®šçš„ç›£æ§å™¨</li>
          <li><strong>æ—¥èªŒæ ¼å¼ï¼š</strong>æ—¥èªŒå°è±¡æ‡‰åŒ…å« { time, type, message } ä¸‰å€‹å±¬æ€§</li>
          <li><strong>æ™‚é–“æ ¼å¼ï¼š</strong>å¯ä»¥ä½¿ç”¨ new Date().toLocaleTimeString() ä¾†æ ¼å¼åŒ–æ™‚é–“</li>
          <li><strong>ç›£æ§å™¨ç®¡ç†ï¼š</strong>å°‡æ‰€æœ‰ç›£æ§å™¨çš„åœæ­¢å‡½æ•¸ä¿å­˜åˆ° watchers.value é™£åˆ—ä¸­</li>
          <li><strong>æ¢ä»¶ç›£æ§ï¼š</strong>å¯ä»¥åœ¨ç›£æ§å‡½æ•¸å…§éƒ¨æª¢æŸ¥å°æ‡‰çš„è¨­å®šç‹€æ…‹</li>
        </ul>
      </div>
    </div>

    <div class="demo-section">
      <h3>ğŸ“Š ç”¨æˆ¶è¡Œç‚ºç›£æ§</h3>
      <div class="user-controls">
        <div class="control-group">
          <label>ç”¨æˆ¶åï¼š</label>
          <input v-model="user.name" placeholder="è¼¸å…¥ç”¨æˆ¶å" class="form-input">
        </div>

        <div class="control-group">
          <label>å¹´é½¡ï¼š</label>
          <input v-model.number="user.age" type="number" placeholder="è¼¸å…¥å¹´é½¡" class="form-input">
        </div>

        <div class="control-group">
          <label>èˆˆè¶£æ„›å¥½ï¼š</label>
          <div class="hobby-list">
            <label v-for="hobby in availableHobbies" :key="hobby" class="checkbox-label">
              <input type="checkbox" :value="hobby" v-model="user.hobbies"> {{ hobby }}
            </label>
          </div>
        </div>

        <div class="control-group">
          <label>æ´»èºåº¦ï¼š</label>
          <input v-model.number="user.activityLevel" type="range" min="0" max="100" class="range-input">
          <span>{{ user.activityLevel }}%</span>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h3>ğŸ” ç›£æ§è¨­å®š</h3>
      <div class="watch-controls">
        <div class="control-group">
          <label class="checkbox-label">
            <input type="checkbox" v-model="watchSettings.enableNameWatch">
            ç›£æ§ç”¨æˆ¶åè®ŠåŒ–
          </label>
        </div>

        <div class="control-group">
          <label class="checkbox-label">
            <input type="checkbox" v-model="watchSettings.enableDeepWatch">
            æ·±åº¦ç›£æ§ç”¨æˆ¶å°è±¡
          </label>
        </div>

        <div class="control-group">
          <label class="checkbox-label">
            <input type="checkbox" v-model="watchSettings.enableActivityWatch">
            ç›£æ§æ´»èºåº¦è®ŠåŒ–
          </label>
        </div>

        <div class="control-group">
          <button @click="clearLogs" class="btn btn-secondary">æ¸…é™¤æ—¥èªŒ</button>
          <button @click="stopAllWatchers" class="btn btn-warning">åœæ­¢æ‰€æœ‰ç›£æ§</button>
          <button @click="startAllWatchers" class="btn btn-primary">é‡æ–°é–‹å§‹ç›£æ§</button>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h3>ğŸ“ˆ çµ±è¨ˆè³‡è¨Š</h3>
      <div class="stats-grid">
        <div class="stat-card">
          <h4>ç¸½è®ŠåŒ–æ¬¡æ•¸</h4>
          <p class="stat-number">{{ totalChanges }}</p>
        </div>

        <div class="stat-card">
          <h4>ç”¨æˆ¶åé•·åº¦</h4>
          <p class="stat-number">{{ user.name.length }}</p>
        </div>

        <div class="stat-card">
          <h4>èˆˆè¶£æ•¸é‡</h4>
          <p class="stat-number">{{ user.hobbies.length }}</p>
        </div>

        <div class="stat-card">
          <h4>ç”¨æˆ¶ç­‰ç´š</h4>
          <p class="stat-number">{{ userLevel }}</p>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h3>ğŸ“ ç›£æ§æ—¥èªŒ</h3>
      <div class="logs-container">
        <div v-if="logs.length === 0" class="no-logs">
          æš«ç„¡ç›£æ§æ—¥èªŒï¼Œè«‹ä¿®æ”¹ä¸Šæ–¹çš„ç”¨æˆ¶è³‡æ–™ä¾†è§¸ç™¼ç›£æ§
        </div>

        <div v-else class="log-list">
          <div v-for="(log, index) in logs" :key="index" class="log-entry" :class="log.type">
            <span class="log-time">{{ log.time }}</span>
            <span class="log-type">{{ log.type }}</span>
            <span class="log-message">{{ log.message }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="hint-section">
      <h4>ğŸ’¡ æç¤ºèˆ‡åƒè€ƒ</h4>
      <details>
        <summary>é»æ“ŠæŸ¥çœ‹å¯¦ä½œæç¤º</summary>
        <pre><code>// åŸºæœ¬ watch ç”¨æ³•
watch(user.name, (newValue, oldValue) => {
  console.log(`ç”¨æˆ¶åå¾ ${oldValue} è®Šç‚º ${newValue}`)
})

// ç›£æ§ ref
const count = ref(0)
watch(count, (newCount) => {
  console.log('è¨ˆæ•¸è®ŠåŒ–:', newCount)
})

// ç›£æ§ reactive å°è±¡çš„å±¬æ€§
watch(() => user.age, (newAge, oldAge) => {
  console.log(`å¹´é½¡å¾ ${oldAge} è®Šç‚º ${newAge}`)
})

// æ·±åº¦ç›£æ§
watch(user, (newUser, oldUser) => {
  console.log('ç”¨æˆ¶å°è±¡ç™¼ç”Ÿè®ŠåŒ–')
}, { deep: true })

// ç›£æ§å¤šå€‹æ•¸æ“šæº
watch([user.name, user.age], ([newName, newAge], [oldName, oldAge]) => {
  console.log('ç”¨æˆ¶åæˆ–å¹´é½¡ç™¼ç”Ÿè®ŠåŒ–')
})

// watchEffect è‡ªå‹•è¿½è¹¤ä¾è³´
watchEffect(() => {
  console.log(`ç”¨æˆ¶ ${user.name} çš„æ´»èºåº¦æ˜¯ ${user.activityLevel}%`)
})

// åœæ­¢ç›£æ§
const stopWatcher = watch(user.name, callback)
// èª¿ç”¨ stopWatcher() ä¾†åœæ­¢ç›£æ§

// æ¢ä»¶æ€§ç›£æ§
watch(user.activityLevel, (level) => {
  if (level > 80) {
    console.log('ç”¨æˆ¶éå¸¸æ´»èºï¼')
  }
}, {
  immediate: true,  // ç«‹å³åŸ·è¡Œä¸€æ¬¡
  flush: 'post'     // åœ¨çµ„ä»¶æ›´æ–°å¾ŒåŸ·è¡Œ
})</code></pre>
      </details>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, computed, watch, watchEffect, onUnmounted } from 'vue'

// ç”¨æˆ¶æ•¸æ“š
const user = reactive({
  name: '',
  age: 0,
  hobbies: [],
  activityLevel: 50
})

// å¯é¸èˆˆè¶£
const availableHobbies = ['é–±è®€', 'é‹å‹•', 'éŸ³æ¨‚', 'æ—…è¡Œ', 'éŠæˆ²', 'æ”å½±']

// ç›£æ§è¨­å®š
const watchSettings = reactive({
  enableNameWatch: true,
  enableDeepWatch: true,
  enableActivityWatch: true
})

// æ—¥èªŒç³»çµ±
const logs = ref([])
const totalChanges = ref(0)

// ç›£æ§å™¨å¼•ç”¨ï¼ˆç”¨æ–¼åœæ­¢ç›£æ§ï¼‰
const watchers = ref([])

// TODO: å®Œæˆä»¥ä¸‹åŠŸèƒ½

// 1. è¨ˆç®—ç”¨æˆ¶ç­‰ç´šï¼ˆåŸºæ–¼å¹´é½¡å’Œæ´»èºåº¦ï¼‰
const userLevel = computed(() => {
  // è«‹åœ¨é€™è£¡å®Œæˆç”¨æˆ¶ç­‰ç´šè¨ˆç®—é‚è¼¯
  return 'Bronze'
})

// 2. æ·»åŠ æ—¥èªŒçš„è¼”åŠ©å‡½æ•¸
const addLog = (type, message) => {
  // è«‹åœ¨é€™è£¡å®Œæˆæ—¥èªŒæ·»åŠ é‚è¼¯

}

// 3. ç›£æ§ç”¨æˆ¶åè®ŠåŒ–
const watchUserName = () => {
  // è«‹åœ¨é€™è£¡ä½¿ç”¨ watch ç›£æ§ user.name çš„è®ŠåŒ–

}

// 4. æ·±åº¦ç›£æ§ç”¨æˆ¶å°è±¡
const watchUserDeep = () => {
  // è«‹åœ¨é€™è£¡ä½¿ç”¨ watch æ·±åº¦ç›£æ§æ•´å€‹ user å°è±¡

}

// 5. ç›£æ§æ´»èºåº¦è®ŠåŒ–
const watchActivityLevel = () => {
  // è«‹åœ¨é€™è£¡ç›£æ§ user.activityLevel çš„è®ŠåŒ–
  // ç•¶æ´»èºåº¦è¶…é 80 æ™‚çµ¦å‡ºç‰¹æ®Šæç¤º

}

// 6. ä½¿ç”¨ watchEffect è‡ªå‹•è¿½è¹¤
const setupWatchEffect = () => {
  // è«‹åœ¨é€™è£¡ä½¿ç”¨ watchEffect è‡ªå‹•è¿½è¹¤ç”¨æˆ¶æ•¸æ“šè®ŠåŒ–

}

// 7. ç›£æ§å¤šå€‹æ•¸æ“šæº
const watchMultipleSources = () => {
  // è«‹åœ¨é€™è£¡åŒæ™‚ç›£æ§ç”¨æˆ¶åå’Œå¹´é½¡çš„è®ŠåŒ–

}

// 8. æ¸…é™¤æ—¥èªŒ
const clearLogs = () => {
  // è«‹åœ¨é€™è£¡å®Œæˆæ¸…é™¤æ—¥èªŒçš„é‚è¼¯

}

// 9. åœæ­¢æ‰€æœ‰ç›£æ§
const stopAllWatchers = () => {
  // è«‹åœ¨é€™è£¡åœæ­¢æ‰€æœ‰æ´»èºçš„ç›£æ§å™¨

}

// 10. é‡æ–°é–‹å§‹ç›£æ§
const startAllWatchers = () => {
  // è«‹åœ¨é€™è£¡é‡æ–°å•Ÿå‹•æ‰€æœ‰ç›£æ§å™¨

}

// çµ„ä»¶å¸è¼‰æ™‚æ¸…ç†
onUnmounted(() => {
  // TODO: æ¸…ç†æ‰€æœ‰ç›£æ§å™¨

})
</script>

<style scoped>
.self-challenge {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}



.challenge-section {
  background: #fff3e0;
  padding: 1.5rem;
  border-radius: 8px;
  margin: 2rem 0;
}

.task-list {
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
}

.task-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem;
  background: white;
  border-radius: 4px;
}

.task-item input[type="checkbox"] {
  width: 18px;
  height: 18px;
}

.demo-section {
  margin: 2rem 0;
  padding: 1.5rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  background: #fafafa;
}

.user-controls,
.watch-controls {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1rem;
  margin: 1rem 0;
}

.control-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.control-group label {
  font-weight: bold;
  color: #333;
}

.form-input {
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.9rem;
}

.range-input {
  width: 100%;
}

.hobby-list {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.checkbox-label {
  display: flex !important;
  align-items: center;
  gap: 0.5rem;
  font-weight: normal !important;
  cursor: pointer;
}

.checkbox-label input {
  width: auto !important;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin: 1rem 0;
}

.stat-card {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  text-align: center;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.stat-number {
  font-size: 1.5rem;
  font-weight: bold;
  color: #1976d2;
  margin: 0.5rem 0;
}

.logs-container {
  background: white;
  border-radius: 8px;
  border: 1px solid #ddd;
  max-height: 400px;
  overflow-y: auto;
}

.no-logs {
  padding: 2rem;
  text-align: center;
  color: #666;
}

.log-list {
  padding: 1rem;
}

.log-entry {
  display: flex;
  gap: 1rem;
  padding: 0.5rem;
  border-bottom: 1px solid #eee;
  font-family: monospace;
  font-size: 0.9rem;
}

.log-entry:last-child {
  border-bottom: none;
}

.log-entry.watch {
  background: #e3f2fd;
}

.log-entry.watchEffect {
  background: #f1f8e9;
}

.log-entry.deep {
  background: #fff3e0;
}

.log-entry.activity {
  background: #fff9c4;
}

.log-time {
  color: #666;
  min-width: 80px;
}

.log-type {
  color: #1976d2;
  font-weight: bold;
  min-width: 100px;
}

.log-message {
  color: #333;
  flex: 1;
}

.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: background-color 0.2s;
  margin-right: 0.5rem;
}

.btn-primary {
  background: #1976d2;
  color: white;
}

.btn-secondary {
  background: #757575;
  color: white;
}

.btn-warning {
  background: #ff9800;
  color: white;
}

.btn:hover {
  opacity: 0.9;
}

.hint-section {
  background: #e8f5e8;
  padding: 1.5rem;
  border-radius: 8px;
  margin: 2rem 0;
}

details {
  margin-top: 1rem;
}

summary {
  cursor: pointer;
  font-weight: bold;
  padding: 0.5rem;
  background: #c8e6c9;
  border-radius: 4px;
}

pre {
  background: #2d3748;
  color: #e2e8f0;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin-top: 1rem;
}

.implementation-section {
  background: #f3e5f5;
  padding: 1.5rem;
  border-radius: 8px;
  margin: 2rem 0;
  border-left: 4px solid #9c27b0;
}

.implementation-intro {
  margin-bottom: 1.5rem;
  font-size: 1rem;
  color: #424242;
}

.implementation-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-bottom: 2rem;
}

.implementation-item {
  background: white;
  border-radius: 8px;
  padding: 1rem;
  border-left: 3px solid #e0e0e0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  transition: all 0.2s ease;
}

.implementation-item:hover {
  border-left-color: #9c27b0;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
}

.function-header {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  margin-bottom: 0.5rem;
}

.function-number {
  background: #9c27b0;
  color: white;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  font-weight: bold;
}

.function-name {
  font-family: 'Courier New', monospace;
  font-weight: bold;
  color: #2e7d32;
  background: #e8f5e8;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  flex: 1;
}

.difficulty {
  padding: 0.2rem 0.6rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: bold;
  text-transform: uppercase;
}

.difficulty.easy {
  background: #c8e6c9;
  color: #2e7d32;
}

.difficulty.medium {
  background: #ffe0b2;
  color: #f57c00;
}

.difficulty.hard {
  background: #ffcdd2;
  color: #d32f2f;
}

.function-description {
  color: #424242;
  line-height: 1.5;
}

.function-description small {
  color: #757575;
  font-style: italic;
  display: block;
  margin-top: 0.3rem;
}

.implementation-tips {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  border: 1px solid #e1bee7;
}

.implementation-tips h4 {
  margin: 0 0 1rem 0;
  color: #9c27b0;
}

.implementation-tips ul {
  margin: 0;
  padding-left: 1.5rem;
}

.implementation-tips li {
  margin-bottom: 0.5rem;
  line-height: 1.4;
}

.implementation-tips strong {
  color: #6a1b9a;
}

.spec-details {
  margin-top: 0.5rem;
  padding: 0.8rem;
  border: 1px solid #e0e0e0;
  border-radius: 4px;
  background: #fafafa;
  font-size: 0.9rem;
}

.spec-details strong {
  font-weight: bold;
  color: #333;
}

.spec-details ul {
  margin: 0.5rem 0 0 0;
  padding-left: 1.2rem;
}

.spec-details li {
  margin-bottom: 0.4rem;
  line-height: 1.4;
}

.spec-details ul ul {
  margin-top: 0.3rem;
  padding-left: 1rem;
}

.spec-details ul ul li {
  margin-bottom: 0.2rem;
  font-size: 0.85rem;
}

.log-entry.activity {
  background: #fff9c4;
}
</style>

<template>
    <div class="key-modifiers-demo">
        <h2>æŒ‰éµä¿®é£¾ç¬¦ (Key Modifiers)</h2>
        <p class="route-info">ğŸ“ è·¯å¾‘ï¼š/EventHandlingSamples/KeyModifiersDemo.vue</p>

        <!-- å¸¸ç”¨æŒ‰éµä¿®é£¾ç¬¦ -->
        <div class="demo-section">
            <h3>1. å¸¸ç”¨æŒ‰éµä¿®é£¾ç¬¦</h3>
            <div class="result">
                <div class="key-examples">
                    <div class="input-group">
                        <label>æŒ‰ Enter æäº¤:</label>
                        <input @keyup.enter="handleEnter" v-model="enterInput" placeholder="è¼¸å…¥å¾ŒæŒ‰ Enter"
                            class="input-field">
                    </div>

                    <div class="input-group">
                        <label>æŒ‰ Tab åˆ‡æ›:</label>
                        <input @keydown.tab="handleTab" v-model="tabInput" placeholder="æŒ‰ Tab è©¦è©¦" class="input-field">
                    </div>

                    <div class="input-group">
                        <label>æŒ‰ Delete æ¸…é™¤:</label>
                        <input @keyup.delete="handleDelete" v-model="deleteInput" placeholder="æŒ‰ Delete æ¸…é™¤"
                            class="input-field">
                    </div>

                    <div class="input-group">
                        <label>æŒ‰ Esc å–æ¶ˆ:</label>
                        <input @keyup.esc="handleEscape" v-model="escInput" placeholder="æŒ‰ Esc å–æ¶ˆ" class="input-field">
                    </div>

                    <div class="input-group">
                        <label>æŒ‰ Space ç¢ºèª:</label>
                        <input @keyup.space="handleSpace" v-model="spaceInput" placeholder="æŒ‰ç©ºæ ¼éµç¢ºèª" class="input-field">
                    </div>
                </div>

                <div class="key-result">
                    <h5>æŒ‰éµæ“ä½œçµæœ:</h5>
                    <ul>
                        <li v-for="(action, index) in keyActions" :key="index">
                            {{ action }}
                        </li>
                    </ul>
                    <button @click="clearKeyActions" class="btn btn-small btn-secondary">æ¸…é™¤è¨˜éŒ„</button>
                </div>
            </div>
            <div class="code-example">
                <pre v-pre><code><!-- å¸¸ç”¨æŒ‰éµä¿®é£¾ç¬¦ -->
&lt;input @keyup.enter="handleEnter"&gt;     <!-- Enter éµ -->
&lt;input @keydown.tab="handleTab"&gt;       <!-- Tab éµ -->
&lt;input @keyup.delete="handleDelete"&gt;   <!-- Delete éµ -->
&lt;input @keyup.esc="handleEscape"&gt;      <!-- Escape éµ -->
&lt;input @keyup.space="handleSpace"&gt;     <!-- ç©ºæ ¼éµ --></code></pre>
            </div>
        </div>

        <!-- æ–¹å‘éµä¿®é£¾ç¬¦ -->
        <div class="demo-section">
            <h3>2. æ–¹å‘éµä¿®é£¾ç¬¦</h3>
            <div class="result">
                <div class="arrow-demo">
                    <div class="game-area" @keyup.up="moveUp" @keyup.down="moveDown" @keyup.left="moveLeft"
                        @keyup.right="moveRight" tabindex="0">
                        <p>é»æ“Šé€™è£¡å¾Œä½¿ç”¨æ–¹å‘éµç§»å‹•</p>
                        <div class="player" :style="{ top: playerPosition.y + 'px', left: playerPosition.x + 'px' }">
                            ğŸ®
                        </div>
                    </div>
                    <div class="controls-info">
                        <p><strong>ä½ç½®:</strong> X: {{ playerPosition.x }}, Y: {{ playerPosition.y }}</p>
                        <p><strong>ç§»å‹•è¨˜éŒ„:</strong> {{ moveHistory.join(' â†’ ') }}</p>
                        <button @click="resetPosition" class="btn btn-small btn-primary">é‡ç½®ä½ç½®</button>
                    </div>
                </div>
            </div>
            <div class="code-example">
                <pre v-pre><code><!-- æ–¹å‘éµä¿®é£¾ç¬¦ -->
&lt;div @keyup.up="moveUp"         <!-- â†‘ éµ -->
     @keyup.down="moveDown"       <!-- â†“ éµ -->
     @keyup.left="moveLeft"       <!-- â† éµ -->
     @keyup.right="moveRight"     <!-- â†’ éµ -->
     tabindex="0"&gt;
  å¯èšç„¦å…ƒç´ 
&lt;/div&gt;</code></pre>
            </div>
        </div>

        <!-- ç³»çµ±ä¿®é£¾ç¬¦ -->
        <div class="demo-section">
            <h3>3. ç³»çµ±ä¿®é£¾ç¬¦</h3>
            <div class="result">
                <div class="system-modifiers">
                    <div class="input-group">
                        <label>Ctrl + Enter å¿«é€Ÿæäº¤:</label>
                        <textarea @keyup.ctrl.enter="handleCtrlEnter" v-model="ctrlText"
                            placeholder="è¼¸å…¥æ–‡å­—ï¼Œç„¶å¾Œ Ctrl + Enter" class="textarea-field"></textarea>
                    </div>

                    <div class="input-group">
                        <label>Alt + S å¿«é€Ÿå„²å­˜:</label>
                        <input @keyup.alt.s="handleAltSave" v-model="altText" placeholder="Alt + S å„²å­˜"
                            class="input-field">
                    </div>

                    <div class="input-group">
                        <label>Shift + Delete å¼·åˆ¶åˆªé™¤:</label>
                        <input @keyup.shift.delete="handleShiftDelete" v-model="shiftText"
                            placeholder="Shift + Delete å¼·åˆ¶åˆªé™¤" class="input-field">
                    </div>

                    <div class="input-group">
                        <label>Meta + Z æ’¤éŠ· (Mac: Cmd, Win: Winéµ):</label>
                        <input @keyup.meta.z="handleMetaUndo" v-model="metaText" placeholder="Meta + Z æ’¤éŠ·"
                            class="input-field">
                    </div>
                </div>

                <div class="system-result">
                    <h5>ç³»çµ±çµ„åˆéµçµæœ:</h5>
                    <ul>
                        <li v-for="(action, index) in systemActions" :key="index">
                            {{ action }}
                        </li>
                    </ul>
                    <button @click="clearSystemActions" class="btn btn-small btn-secondary">æ¸…é™¤è¨˜éŒ„</button>
                </div>
            </div>
            <div class="code-example">
                <pre v-pre><code><!-- ç³»çµ±ä¿®é£¾ç¬¦çµ„åˆ -->
&lt;input @keyup.ctrl.enter="ctrlEnterHandler"&gt;
&lt;input @keyup.alt.s="altSaveHandler"&gt;
&lt;input @keyup.shift.delete="shiftDeleteHandler"&gt;
&lt;input @keyup.meta.z="metaUndoHandler"&gt;

<!-- å¯ä»¥çµ„åˆå¤šå€‹ç³»çµ±ä¿®é£¾ç¬¦ -->
&lt;input @keyup.ctrl.shift.s="advancedSave"&gt;</code></pre>
            </div>
        </div>

        <!-- å¯¦ç”¨å¿«æ·éµç¯„ä¾‹ -->
        <div class="demo-section">
            <h3>4. å¯¦ç”¨å¿«æ·éµçµ„åˆç¯„ä¾‹</h3>
            <div class="result">
                <div class="shortcut-demo">
                    <div class="editor-area" tabindex="0" @keyup.ctrl.s="saveDocument" @keyup.ctrl.z="undoAction"
                        @keyup.ctrl.y="redoAction" @keyup.ctrl.a="selectAll" @keyup.f5="refreshView">
                        <h4>æ¨¡æ“¬ç·¨è¼¯å™¨ (é»æ“Šé€™è£¡ç²å¾—ç„¦é»)</h4>
                        <textarea v-model="editorContent" placeholder="åœ¨é€™è£¡è¼¸å…¥å…§å®¹..." class="editor-content"></textarea>
                        <div class="shortcut-hints">
                            <p><strong>å¯ç”¨å¿«æ·éµ:</strong></p>
                            <ul>
                                <li>Ctrl + S: å„²å­˜</li>
                                <li>Ctrl + Z: æ’¤éŠ·</li>
                                <li>Ctrl + Y: é‡åš</li>
                                <li>Ctrl + A: å…¨é¸</li>
                                <li>F5: é‡æ–°æ•´ç†</li>
                            </ul>
                        </div>
                    </div>

                    <div class="shortcut-result">
                        <h5>å¿«æ·éµæ“ä½œè¨˜éŒ„:</h5>
                        <ul>
                            <li v-for="(action, index) in shortcutActions" :key="index">
                                {{ action }}
                            </li>
                        </ul>
                        <button @click="clearShortcutActions" class="btn btn-small btn-secondary">æ¸…é™¤è¨˜éŒ„</button>
                    </div>
                </div>
            </div>
            <div class="code-example">
                <pre v-pre><code><!-- å¯¦ç”¨å¿«æ·éµçµ„åˆ -->
&lt;div @keyup.ctrl.s="saveDocument"      <!-- Ctrl + S å„²å­˜ -->
     @keyup.ctrl.z="undoAction"         <!-- Ctrl + Z æ’¤éŠ· -->
     @keyup.ctrl.y="redoAction"         <!-- Ctrl + Y é‡åš -->
     @keyup.ctrl.a="selectAll"          <!-- Ctrl + A å…¨é¸ -->
     @keyup.f5="refreshView"            <!-- F5 é‡æ–°æ•´ç† -->
     tabindex="0"&gt;
  ç·¨è¼¯å™¨å…§å®¹
&lt;/div&gt;</code></pre>
            </div>
        </div>
    </div>
</template>

<script setup>
import { ref } from 'vue'

// å¸¸ç”¨æŒ‰éµä¿®é£¾ç¬¦
const enterInput = ref('')
const tabInput = ref('')
const deleteInput = ref('')
const escInput = ref('')
const spaceInput = ref('')
const keyActions = ref([])

const addKeyAction = (action) => {
    const timestamp = new Date().toLocaleTimeString()
    keyActions.value.unshift(`${timestamp} - ${action}`)
    if (keyActions.value.length > 10) keyActions.value.pop()
}

const handleEnter = () => {
    addKeyAction(`Enter éµè§¸ç™¼ï¼Œå…§å®¹: "${enterInput.value}"`)
}

const handleTab = () => {
    addKeyAction(`Tab éµè§¸ç™¼ï¼Œå…§å®¹: "${tabInput.value}"`)
}

const handleDelete = () => {
    deleteInput.value = ''
    addKeyAction('Delete éµè§¸ç™¼ï¼Œå…§å®¹å·²æ¸…é™¤')
}

const handleEscape = () => {
    escInput.value = ''
    addKeyAction('Escape éµè§¸ç™¼ï¼Œå…§å®¹å·²å–æ¶ˆ')
}

const handleSpace = () => {
    addKeyAction(`Space éµè§¸ç™¼ï¼Œå…§å®¹ç¢ºèª: "${spaceInput.value}"`)
}

const clearKeyActions = () => {
    keyActions.value = []
}

// æ–¹å‘éµç¯„ä¾‹
const playerPosition = ref({ x: 100, y: 100 })
const moveHistory = ref([])

const moveUp = () => {
    playerPosition.value.y = Math.max(0, playerPosition.value.y - 20)
    moveHistory.value.push('ä¸Š')
    if (moveHistory.value.length > 10) moveHistory.value.shift()
}

const moveDown = () => {
    playerPosition.value.y = Math.min(200, playerPosition.value.y + 20)
    moveHistory.value.push('ä¸‹')
    if (moveHistory.value.length > 10) moveHistory.value.shift()
}

const moveLeft = () => {
    playerPosition.value.x = Math.max(0, playerPosition.value.x - 20)
    moveHistory.value.push('å·¦')
    if (moveHistory.value.length > 10) moveHistory.value.shift()
}

const moveRight = () => {
    playerPosition.value.x = Math.min(300, playerPosition.value.x + 20)
    moveHistory.value.push('å³')
    if (moveHistory.value.length > 10) moveHistory.value.shift()
}

const resetPosition = () => {
    playerPosition.value = { x: 100, y: 100 }
    moveHistory.value = []
}

// ç³»çµ±ä¿®é£¾ç¬¦
const ctrlText = ref('')
const altText = ref('')
const shiftText = ref('')
const metaText = ref('')
const systemActions = ref([])

const addSystemAction = (action) => {
    const timestamp = new Date().toLocaleTimeString()
    systemActions.value.unshift(`${timestamp} - ${action}`)
    if (systemActions.value.length > 8) systemActions.value.pop()
}

const handleCtrlEnter = () => {
    addSystemAction(`Ctrl + Enter: å¿«é€Ÿæäº¤ "${ctrlText.value}"`)
}

const handleAltSave = () => {
    addSystemAction(`Alt + S: å¿«é€Ÿå„²å­˜ "${altText.value}"`)
}

const handleShiftDelete = () => {
    const content = shiftText.value
    shiftText.value = ''
    addSystemAction(`Shift + Delete: å¼·åˆ¶åˆªé™¤ "${content}"`)
}

const handleMetaUndo = () => {
    addSystemAction(`Meta + Z: æ’¤éŠ·æ“ä½œ "${metaText.value}"`)
}

const clearSystemActions = () => {
    systemActions.value = []
}

// å¿«æ·éµç¯„ä¾‹
const editorContent = ref('åœ¨é€™è£¡è¼¸å…¥ä¸€äº›å…§å®¹ä¾†æ¸¬è©¦å¿«æ·éµ...')
const shortcutActions = ref([])

const addShortcutAction = (action) => {
    const timestamp = new Date().toLocaleTimeString()
    shortcutActions.value.unshift(`${timestamp} - ${action}`)
    if (shortcutActions.value.length > 10) shortcutActions.value.pop()
}

const saveDocument = () => {
    addShortcutAction('ğŸ“„ æ–‡ä»¶å·²å„²å­˜ (Ctrl + S)')
}

const undoAction = () => {
    addShortcutAction('â†¶ æ’¤éŠ·æ“ä½œ (Ctrl + Z)')
}

const redoAction = () => {
    addShortcutAction('â†· é‡åšæ“ä½œ (Ctrl + Y)')
}

const selectAll = () => {
    addShortcutAction('ğŸ“ å…¨é¸æ–‡å­— (Ctrl + A)')
}

const refreshView = () => {
    addShortcutAction('ğŸ”„ é‡æ–°æ•´ç†æª¢è¦– (F5)')
}

const clearShortcutActions = () => {
    shortcutActions.value = []
}
</script>

<template>
  <div class="list-rendering-demo">
    <h2>éŸ¿æ‡‰å¼æ•¸çµ„æ“ä½œ</h2>
    <p class="route-info">ğŸ“ è·¯å¾‘ï¼š/ListSamples/ReactiveArrayDemo.vue</p>
    <p class="description">
      åœ¨ Vue 2 ä¸­ï¼ŒæŸäº›æ•¸çµ„æ“ä½œä¸æœƒè§¸ç™¼éŸ¿æ‡‰å¼æ›´æ–°ï¼Œä½†åœ¨ Vue 3 ä¸­å·²ç¶“ä¿®å¾©
    </p>

    <div class="demo-section">
      <h3>Vue 3 ä¸­çš„æ•¸çµ„æ“ä½œ (éƒ½æ˜¯éŸ¿æ‡‰å¼çš„) <span class="code-path">ReactiveArrayDemo.vue</span></h3>
      <div class="controls">
        <button @click="directIndexAssignment" class="btn btn-primary">
          ç›´æ¥ç´¢å¼•è³¦å€¼ (Vue 2 ä¸­æœ‰å•é¡Œ)
        </button>
        <button @click="modifyLength" class="btn btn-primary">
          ä¿®æ”¹ length å±¬æ€§ (Vue 2 ä¸­æœ‰å•é¡Œ)
        </button>
        <button @click="resetReactiveList" class="btn btn-secondary">é‡ç½®</button>
      </div>

      <div class="result">
        <div class="reactive-list">
          <div v-for="(item, index) in reactiveList" :key="item.id" class="reactive-item">
            <span>ç´¢å¼• {{ index }}: {{ item.name }} - {{ item.value }}</span>
          </div>
        </div>
      </div>

      <div class="code-example">
        <pre v-pre><code>// Vue 3 ä¸­æ‰€æœ‰æ•¸çµ„æ“ä½œéƒ½æ˜¯éŸ¿æ‡‰å¼çš„
const list = ref([...])

// ç›´æ¥ç´¢å¼•è³¦å€¼ - Vue 3 ä¸­å¯ä»¥æ­£å¸¸å·¥ä½œ
list.value[0] = newValue

// ä¿®æ”¹ length å±¬æ€§ - Vue 3 ä¸­å¯ä»¥æ­£å¸¸å·¥ä½œ
list.value.length = 2</code></pre>
      </div>

      <div class="info-box">
        <h4>ğŸ’¡ Vue 2 ä¸­éœ€è¦ä½¿ç”¨çš„è§£æ±ºæ–¹æ¡ˆï¼š</h4>
        <pre v-pre><code>// Vue 2 ä¸­çš„è§£æ±ºæ–¹æ¡ˆ
// 1. ä½¿ç”¨ Vue.set æˆ– this.$set
this.$set(this.items, index, newValue)

// 2. ä½¿ç”¨æ•¸çµ„çš„ splice æ–¹æ³•
this.items.splice(index, 1, newValue)

// 3. æ›¿æ›æ•´å€‹æ•¸çµ„
this.items = [...this.items]</code></pre>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'

// éŸ¿æ‡‰å¼æ¸¬è©¦åˆ—è¡¨
const reactiveList = ref([
  { id: 1, name: 'Item 1', value: 100 },
  { id: 2, name: 'Item 2', value: 200 },
  { id: 3, name: 'Item 3', value: 300 }
])

// éŸ¿æ‡‰å¼æ¸¬è©¦æ–¹æ³•
const directIndexAssignment = () => {
  reactiveList.value[0] = {
    id: Date.now(),
    name: 'ç›´æ¥è³¦å€¼é …ç›®',
    value: 999
  }
}

const modifyLength = () => {
  reactiveList.value.length = 2
}

const resetReactiveList = () => {
  reactiveList.value = [
    { id: 1, name: 'Item 1', value: 100 },
    { id: 2, name: 'Item 2', value: 200 },
    { id: 3, name: 'Item 3', value: 300 }
  ]
}
</script>

<style scoped>
/* çµ„ä»¶æ¨£å¼å·²åœ¨å…¨åŸŸ main.css ä¸­å®šç¾© */
</style>
